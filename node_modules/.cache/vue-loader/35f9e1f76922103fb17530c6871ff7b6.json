{"remainingRequest":"D:\\云晟\\前端\\ant-design-vue-jeecg-464dd20b46384272b779e066c2f4fcdfa718b326\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\云晟\\前端\\ant-design-vue-jeecg-464dd20b46384272b779e066c2f4fcdfa718b326\\src\\views\\system\\modules\\DepartDataruleModal.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\云晟\\前端\\ant-design-vue-jeecg-464dd20b46384272b779e066c2f4fcdfa718b326\\src\\views\\system\\modules\\DepartDataruleModal.vue","mtime":1665386876000},{"path":"D:\\云晟\\前端\\ant-design-vue-jeecg-464dd20b46384272b779e066c2f4fcdfa718b326\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1665642925904},{"path":"D:\\云晟\\前端\\ant-design-vue-jeecg-464dd20b46384272b779e066c2f4fcdfa718b326\\node_modules\\babel-loader\\lib\\index.js","mtime":1665642924601},{"path":"D:\\云晟\\前端\\ant-design-vue-jeecg-464dd20b46384272b779e066c2f4fcdfa718b326\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1665642925904},{"path":"D:\\云晟\\前端\\ant-design-vue-jeecg-464dd20b46384272b779e066c2f4fcdfa718b326\\node_modules\\vue-loader\\lib\\index.js","mtime":1665642924058}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport ARow from 'ant-design-vue/es/grid/Row'\nimport ACol from 'ant-design-vue/es/grid/Col'\nimport { getAction,postAction } from '@/api/manage'\n\nexport default {\n  name: 'DepartDataruleModal',\n  components: { ACol, ARow },\n  data(){\n    return {\n      functionId:'',\n      departId:'',\n      visible:false,\n      tabList: [{\n        key: '1',\n        tab: '数据规则',\n      }, {\n        key: '2',\n        tab: '按钮权限',\n      }],\n      activeTabKey: '1',\n      url:{\n        datarule:\"/sys/sysDepartPermission/datarule\",\n      },\n      dataruleList:[],\n      dataruleChecked:[]\n    }\n  },\n  methods:{\n    loadData(){\n      getAction(`${this.url.datarule}/${this.functionId}/${this.departId}`).then(res=>{\n        if(res.success){\n          this.dataruleList = res.result.datarule\n          let drChecked = res.result.drChecked\n          if(drChecked){\n            this.dataruleChecked = drChecked.split(\",\")\n          }\n        }\n      })\n    },\n    saveDataruleForRole(){\n      if(!this.dataruleChecked || this.dataruleChecked.length==0){\n        this.$message.warning(\"请注意，现未勾选任何数据权限!\")\n      }\n      let params = {\n        permissionId:this.functionId,\n        departId:this.departId,\n        dataRuleIds:this.dataruleChecked.join(\",\")\n      }\n      postAction(this.url.datarule,params).then(res=>{\n        if(res.success){\n          this.$message.success(res.message)\n        }else{\n          this.$message.error(res.message)\n        }\n      })\n    },\n    show(functionId,departId){\n      this.onReset()\n      this.functionId = functionId\n      this.departId = departId\n      this.visible=true\n      this.loadData()\n    },\n    onClose(){\n      this.visible=false\n      this.onReset()\n    },\n    onTabChange (key) {\n      this.activeTabKey = key\n    },\n    onReset(){\n      this.functionId=''\n      this.departId=''\n      this.dataruleList=[]\n      this.dataruleChecked=[]\n    }\n  }\n}\n",{"version":3,"sources":["DepartDataruleModal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiCA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"DepartDataruleModal.vue","sourceRoot":"src/views/system/modules","sourcesContent":["<template>\n  <a-drawer\n    title=\"数据规则/按钮权限配置\"\n    width=\"365\"\n    :closable=\"false\"\n    @close=\"onClose\"\n    :visible=\"visible\"\n  >\n    <a-tabs defaultActiveKey=\"1\">\n      <a-tab-pane tab=\"数据规则\" key=\"1\">\n\n        <a-checkbox-group v-model=\"dataruleChecked\" v-if=\"dataruleList.length>0\">\n          <a-row>\n            <a-col :span=\"24\" v-for=\"(item,index) in dataruleList\" :key=\" 'dr'+index \">\n              <a-checkbox :value=\"item.id\">{{ item.ruleName }}</a-checkbox>\n            </a-col>\n\n            <a-col :span=\"24\">\n              <div style=\"width: 100%;margin-top: 15px\">\n                <a-button @click=\"saveDataruleForRole\" type=\"primary\" size=\"small\" icon=\"save\">点击保存</a-button>\n              </div>\n            </a-col>\n          </a-row>\n        </a-checkbox-group>\n        <div v-else><h3>无配置信息!</h3></div>\n\n      </a-tab-pane>\n    </a-tabs>\n\n  </a-drawer>\n</template>\n\n<script>\n  import ARow from 'ant-design-vue/es/grid/Row'\n  import ACol from 'ant-design-vue/es/grid/Col'\n  import { getAction,postAction } from '@/api/manage'\n\n  export default {\n    name: 'DepartDataruleModal',\n    components: { ACol, ARow },\n    data(){\n      return {\n        functionId:'',\n        departId:'',\n        visible:false,\n        tabList: [{\n          key: '1',\n          tab: '数据规则',\n        }, {\n          key: '2',\n          tab: '按钮权限',\n        }],\n        activeTabKey: '1',\n        url:{\n          datarule:\"/sys/sysDepartPermission/datarule\",\n        },\n        dataruleList:[],\n        dataruleChecked:[]\n      }\n    },\n    methods:{\n      loadData(){\n        getAction(`${this.url.datarule}/${this.functionId}/${this.departId}`).then(res=>{\n          if(res.success){\n            this.dataruleList = res.result.datarule\n            let drChecked = res.result.drChecked\n            if(drChecked){\n              this.dataruleChecked = drChecked.split(\",\")\n            }\n          }\n        })\n      },\n      saveDataruleForRole(){\n        if(!this.dataruleChecked || this.dataruleChecked.length==0){\n          this.$message.warning(\"请注意，现未勾选任何数据权限!\")\n        }\n        let params = {\n          permissionId:this.functionId,\n          departId:this.departId,\n          dataRuleIds:this.dataruleChecked.join(\",\")\n        }\n        postAction(this.url.datarule,params).then(res=>{\n          if(res.success){\n            this.$message.success(res.message)\n          }else{\n            this.$message.error(res.message)\n          }\n        })\n      },\n      show(functionId,departId){\n        this.onReset()\n        this.functionId = functionId\n        this.departId = departId\n        this.visible=true\n        this.loadData()\n      },\n      onClose(){\n        this.visible=false\n        this.onReset()\n      },\n      onTabChange (key) {\n        this.activeTabKey = key\n      },\n      onReset(){\n        this.functionId=''\n        this.departId=''\n        this.dataruleList=[]\n        this.dataruleChecked=[]\n      }\n    }\n  }\n</script>\n\n<style scoped>\n\n</style>"]}]}