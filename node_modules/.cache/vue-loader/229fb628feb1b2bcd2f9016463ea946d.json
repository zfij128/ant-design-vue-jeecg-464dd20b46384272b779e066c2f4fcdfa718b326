{"remainingRequest":"D:\\云晟\\前端\\ant-design-vue-jeecg-464dd20b46384272b779e066c2f4fcdfa718b326\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\云晟\\前端\\ant-design-vue-jeecg-464dd20b46384272b779e066c2f4fcdfa718b326\\src\\views\\jeecg\\TableOrderTotal.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\云晟\\前端\\ant-design-vue-jeecg-464dd20b46384272b779e066c2f4fcdfa718b326\\src\\views\\jeecg\\TableOrderTotal.vue","mtime":1665386876000},{"path":"D:\\云晟\\前端\\ant-design-vue-jeecg-464dd20b46384272b779e066c2f4fcdfa718b326\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1665642925904},{"path":"D:\\云晟\\前端\\ant-design-vue-jeecg-464dd20b46384272b779e066c2f4fcdfa718b326\\node_modules\\babel-loader\\lib\\index.js","mtime":1665642924601},{"path":"D:\\云晟\\前端\\ant-design-vue-jeecg-464dd20b46384272b779e066c2f4fcdfa718b326\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1665642925904},{"path":"D:\\云晟\\前端\\ant-design-vue-jeecg-464dd20b46384272b779e066c2f4fcdfa718b326\\node_modules\\vue-loader\\lib\\index.js","mtime":1665642924058}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n  name: 'TableTotal',\n  data() {\n    return {\n      columns: [\n        {\n          title: '#',\n          width: '180px',\n          align: 'center',\n          dataIndex: 'rowIndex',\n          customRender: function (text, r, index) {\n            return (text !== '总计') ? (parseInt(index) + 1) : text\n          }\n        },\n        {\n          title: '姓名',\n          dataIndex: 'name',\n          width: 180,\n        },\n        {\n          title: '贡献点',\n          dataIndex: 'point',\n          width: 180,\n        },\n        {\n          title: '等级',\n          dataIndex: 'level',\n          width: 180,\n        },\n        {\n          title: '更新时间',\n          dataIndex: 'updateTime',\n          width: 180,\n        },\n      ],\n      /* 分页参数 */\n      ipagination:{\n        current: 1,\n        pageSize: 10,\n      },\n      dataSource: [\n        { id:\"1\",name: '张三', point: 23, level: 3, updateTime: '2019-8-14' },\n        { name: '小王', point: 6, level: 1, updateTime: '2019-8-13' },\n        { name: '李四', point: 53, level: 8, updateTime: '2019-8-12' },\n        { name: '小红', point: 44, level: 5, updateTime: '2019-8-11' },\n        { name: '王五', point: 97, level: 10, updateTime: '2019-8-10' },\n        { name: '小明', point: 33, level: 2, updateTime: '2019-8-10' },\n        { name: '小张', point: 33, level: 2, updateTime: '2019-8-10' },\n        { name: '小六', point: 33, level: 2, updateTime: '2019-8-10' },\n        { name: '小五', point: 33, level: 2, updateTime: '2019-8-10' },\n        { name: '小赵', point: 33, level: 2, updateTime: '2019-8-10' },\n        { name: '李华', point: 33, level: 2, updateTime: '2019-8-10' },\n        { name: '小康', point: 33, level: 2, updateTime: '2019-8-10' },\n        { name: '小鹿', point: 33, level: 2, updateTime: '2019-8-10' },\n      ],\n      newArr:[],\n      newDataSource:[],\n      footerDataSource: [],\n      pageSwitch:true\n    }\n  },\n  computed:{\n    // 数据表格的固定属性\n    tableProps(){\n      let tableProps = {\n        size: 'middle',\n        rowKey:'rowIndex',\n        columns: this.columns,\n        scroll: {x: true},\n      }\n      let renderFooter = this.footerDataSource.length === 0 ? null : () => this.renderTableFooter(tableProps)\n      return {\n        ...tableProps,\n        ref: 'table',\n        class: 'chart-data-list',\n        pagination:this.pageSwitch?this.ipagination:false,\n        columns: this.columns,\n        dataSource: this.dataSource,\n        footer: renderFooter,\n      }\n    },\n    pageSwitchProps() {\n      return {\n        checkedChildren: '分页',\n        unCheckedChildren: '分页',\n        style: {\n          position: 'absolute',\n          right: '0px',\n          top: '-10px'\n        }\n      }\n    },\n  },\n  mounted() {\n    // this.tableAddTotalRow(this.columns, this.dataSource)\n    /*新增分页合计方法*/\n    this.newDataSource=this.dataSource\n    this.dataHandling(1,this.ipagination.pageSize)\n  },\n  watch:{\n    //update-begin---author:wangshuai ---date:20220209  for：[JTC-494]常用示例->表格合计写法改成新的写法------------\n    'pageSwitch':function(val){\n       if(!val){\n         this.dataHandling('-1',0)\n       }else{\n         this.dataHandling(1,this.ipagination.pageSize)\n       }\n    },\n    'ipagination.current':function(val) {\n      this.dataHandling(val,this.ipagination.pageSize)\n    },\n    //当合计行变化时，绑定滚动条\n    'footerDataSource': {\n      async handler(dataSource) {\n        // 当底部合计行有值，并且显示出来时，再同步滚动条\n        if (dataSource && dataSource.length > 0) {\n          await this.$nextTick()\n          // 同步表与footer滚动\n          let dom = this.$refs.table.$el.querySelectorAll('.ant-table-body')[0]\n          let footerDom = this.$refs.footerTable.$el.querySelectorAll('.ant-table-body')[0]\n          dom.addEventListener(\n              'scroll',\n              () => {\n                footerDom.scrollLeft = dom.scrollLeft\n              },\n              true,\n          )\n        }\n      },\n      //update-end---author:wangshuai ---date:20220209  for：[JTC-494]常用示例->表格合计写法改成新的写法------------\n    }\n  },\n  methods: {\n    /** 表格增加合计行 */\n    tableAddTotalRow(columns, dataSource) {\n      let numKey = 'rowIndex'\n      let totalRow = { [numKey]: '合计' }\n      columns.forEach(column => {\n        let { key, dataIndex } = column\n        if (![key, dataIndex].includes(numKey)) {\n\n          let total = 0\n          dataSource.forEach(data => {\n            total += /^\\d+\\.?\\d?$/.test(data[dataIndex]) ? Number.parseInt(data[dataIndex]) : Number.NaN\n            console.log(data[dataIndex], ':', (/^\\d+\\.?\\d?$/.test(data[dataIndex]) ? Number.parseInt(data[dataIndex]) : Number.NaN))\n          })\n\n          if (Number.isNaN(total)) {\n            total = '-'\n          }\n          totalRow[dataIndex] = total\n        }\n      })\n\n      dataSource.push(totalRow)\n    },\n    handleTableChange(pagination, filters, sorter) {\n      this.ipagination = pagination;\n    },\n    //update-begin---author:wangshuai ---date:20220209  for：[JTC-494]常用示例->表格合计写法改成新的写法------------\n    /*如果分页走这个方法*/\n    dataHandling(pageNo,pageSize) {\n      //根据当前页数和每页显示条数分割数组\n      let arrs = [];\n      //如果pageNo不是-1（不分页）,那么需要对数据进行分页计算\n      if(pageNo!=-1){\n        arrs = this.newDataSource.slice((pageNo-1)*pageSize,pageNo*pageSize)\n      }else{\n        arrs = this.newDataSource\n      }\n      let newDataSource=[];\n      let newArr= { };\n      newArr.rowIndex=\"总计\"\n      let level=0;\n      let point=0;\n      //每一项的数值相加\n      for (let j=0;j<arrs.length;j++){\n        level+=arrs[j].level;\n        point+=arrs[j].point;\n      }\n      newArr.level=level;\n      newArr.point=point;\n      newDataSource.push(newArr);\n      //给foot底部数组赋值\n      this.footerDataSource = newDataSource;\n    },\n    // 渲染表格底部合计行\n    renderTableFooter(tableProps) {\n      let h = this.$createElement\n      return h('a-table', {\n        ref: 'footerTable',\n        props: {\n          ...tableProps,\n          pagination: false,\n          dataSource: this.footerDataSource,\n          showHeader: false,\n        },\n      })\n      //update-end---author:wangshuai ---date:20220209  for：[JTC-494]常用示例->表格合计写法改成新的写法------------\n    }\n  }\n}\n",{"version":3,"sources":["TableOrderTotal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAmBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TableOrderTotal.vue","sourceRoot":"src/views/jeecg","sourcesContent":["<template>\n  <a-card :bordered=\"false\">\n    <a-row>\n      <a-col>\n        <a-switch v-bind=\"pageSwitchProps\" v-model=\"pageSwitch\"/>\n      </a-col>\n      <a-col>\n        <a-table\n            v-bind=\"tableProps\"\n            @change=\"handleTableChange\"\n            style=\"margin-top: 20px\"\n        >\n        </a-table>\n      </a-col>\n    </a-row>\n  </a-card>\n</template>\n\n<script>\n  export default {\n    name: 'TableTotal',\n    data() {\n      return {\n        columns: [\n          {\n            title: '#',\n            width: '180px',\n            align: 'center',\n            dataIndex: 'rowIndex',\n            customRender: function (text, r, index) {\n              return (text !== '总计') ? (parseInt(index) + 1) : text\n            }\n          },\n          {\n            title: '姓名',\n            dataIndex: 'name',\n            width: 180,\n          },\n          {\n            title: '贡献点',\n            dataIndex: 'point',\n            width: 180,\n          },\n          {\n            title: '等级',\n            dataIndex: 'level',\n            width: 180,\n          },\n          {\n            title: '更新时间',\n            dataIndex: 'updateTime',\n            width: 180,\n          },\n        ],\n        /* 分页参数 */\n        ipagination:{\n          current: 1,\n          pageSize: 10,\n        },\n        dataSource: [\n          { id:\"1\",name: '张三', point: 23, level: 3, updateTime: '2019-8-14' },\n          { name: '小王', point: 6, level: 1, updateTime: '2019-8-13' },\n          { name: '李四', point: 53, level: 8, updateTime: '2019-8-12' },\n          { name: '小红', point: 44, level: 5, updateTime: '2019-8-11' },\n          { name: '王五', point: 97, level: 10, updateTime: '2019-8-10' },\n          { name: '小明', point: 33, level: 2, updateTime: '2019-8-10' },\n          { name: '小张', point: 33, level: 2, updateTime: '2019-8-10' },\n          { name: '小六', point: 33, level: 2, updateTime: '2019-8-10' },\n          { name: '小五', point: 33, level: 2, updateTime: '2019-8-10' },\n          { name: '小赵', point: 33, level: 2, updateTime: '2019-8-10' },\n          { name: '李华', point: 33, level: 2, updateTime: '2019-8-10' },\n          { name: '小康', point: 33, level: 2, updateTime: '2019-8-10' },\n          { name: '小鹿', point: 33, level: 2, updateTime: '2019-8-10' },\n        ],\n        newArr:[],\n        newDataSource:[],\n        footerDataSource: [],\n        pageSwitch:true\n      }\n    },\n    computed:{\n      // 数据表格的固定属性\n      tableProps(){\n        let tableProps = {\n          size: 'middle',\n          rowKey:'rowIndex',\n          columns: this.columns,\n          scroll: {x: true},\n        }\n        let renderFooter = this.footerDataSource.length === 0 ? null : () => this.renderTableFooter(tableProps)\n        return {\n          ...tableProps,\n          ref: 'table',\n          class: 'chart-data-list',\n          pagination:this.pageSwitch?this.ipagination:false,\n          columns: this.columns,\n          dataSource: this.dataSource,\n          footer: renderFooter,\n        }\n      },\n      pageSwitchProps() {\n        return {\n          checkedChildren: '分页',\n          unCheckedChildren: '分页',\n          style: {\n            position: 'absolute',\n            right: '0px',\n            top: '-10px'\n          }\n        }\n      },\n    },\n    mounted() {\n      // this.tableAddTotalRow(this.columns, this.dataSource)\n      /*新增分页合计方法*/\n      this.newDataSource=this.dataSource\n      this.dataHandling(1,this.ipagination.pageSize)\n    },\n    watch:{\n      //update-begin---author:wangshuai ---date:20220209  for：[JTC-494]常用示例->表格合计写法改成新的写法------------\n      'pageSwitch':function(val){\n         if(!val){\n           this.dataHandling('-1',0)\n         }else{\n           this.dataHandling(1,this.ipagination.pageSize)\n         }\n      },\n      'ipagination.current':function(val) {\n        this.dataHandling(val,this.ipagination.pageSize)\n      },\n      //当合计行变化时，绑定滚动条\n      'footerDataSource': {\n        async handler(dataSource) {\n          // 当底部合计行有值，并且显示出来时，再同步滚动条\n          if (dataSource && dataSource.length > 0) {\n            await this.$nextTick()\n            // 同步表与footer滚动\n            let dom = this.$refs.table.$el.querySelectorAll('.ant-table-body')[0]\n            let footerDom = this.$refs.footerTable.$el.querySelectorAll('.ant-table-body')[0]\n            dom.addEventListener(\n                'scroll',\n                () => {\n                  footerDom.scrollLeft = dom.scrollLeft\n                },\n                true,\n            )\n          }\n        },\n        //update-end---author:wangshuai ---date:20220209  for：[JTC-494]常用示例->表格合计写法改成新的写法------------\n      }\n    },\n    methods: {\n      /** 表格增加合计行 */\n      tableAddTotalRow(columns, dataSource) {\n        let numKey = 'rowIndex'\n        let totalRow = { [numKey]: '合计' }\n        columns.forEach(column => {\n          let { key, dataIndex } = column\n          if (![key, dataIndex].includes(numKey)) {\n\n            let total = 0\n            dataSource.forEach(data => {\n              total += /^\\d+\\.?\\d?$/.test(data[dataIndex]) ? Number.parseInt(data[dataIndex]) : Number.NaN\n              console.log(data[dataIndex], ':', (/^\\d+\\.?\\d?$/.test(data[dataIndex]) ? Number.parseInt(data[dataIndex]) : Number.NaN))\n            })\n\n            if (Number.isNaN(total)) {\n              total = '-'\n            }\n            totalRow[dataIndex] = total\n          }\n        })\n\n        dataSource.push(totalRow)\n      },\n      handleTableChange(pagination, filters, sorter) {\n        this.ipagination = pagination;\n      },\n      //update-begin---author:wangshuai ---date:20220209  for：[JTC-494]常用示例->表格合计写法改成新的写法------------\n      /*如果分页走这个方法*/\n      dataHandling(pageNo,pageSize) {\n        //根据当前页数和每页显示条数分割数组\n        let arrs = [];\n        //如果pageNo不是-1（不分页）,那么需要对数据进行分页计算\n        if(pageNo!=-1){\n          arrs = this.newDataSource.slice((pageNo-1)*pageSize,pageNo*pageSize)\n        }else{\n          arrs = this.newDataSource\n        }\n        let newDataSource=[];\n        let newArr= { };\n        newArr.rowIndex=\"总计\"\n        let level=0;\n        let point=0;\n        //每一项的数值相加\n        for (let j=0;j<arrs.length;j++){\n          level+=arrs[j].level;\n          point+=arrs[j].point;\n        }\n        newArr.level=level;\n        newArr.point=point;\n        newDataSource.push(newArr);\n        //给foot底部数组赋值\n        this.footerDataSource = newDataSource;\n      },\n      // 渲染表格底部合计行\n      renderTableFooter(tableProps) {\n        let h = this.$createElement\n        return h('a-table', {\n          ref: 'footerTable',\n          props: {\n            ...tableProps,\n            pagination: false,\n            dataSource: this.footerDataSource,\n            showHeader: false,\n          },\n        })\n        //update-end---author:wangshuai ---date:20220209  for：[JTC-494]常用示例->表格合计写法改成新的写法------------\n      }\n    }\n  }\n</script>\n\n<style scoped lang=\"less\">\n/deep/ .chart-data-list .ant-table-footer .ant-table-body{\n  overflow: hidden !important;\n}\n/deep/ .ant-table-footer{\n  padding:0;\n}\n</style>"]}]}