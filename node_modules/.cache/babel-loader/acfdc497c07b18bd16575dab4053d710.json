{"remainingRequest":"D:\\云晟\\前端\\ant-design-vue-jeecg-464dd20b46384272b779e066c2f4fcdfa718b326\\node_modules\\babel-loader\\lib\\index.js!D:\\云晟\\前端\\ant-design-vue-jeecg-464dd20b46384272b779e066c2f4fcdfa718b326\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\云晟\\前端\\ant-design-vue-jeecg-464dd20b46384272b779e066c2f4fcdfa718b326\\src\\mixins\\JeecgListMixin.js","dependencies":[{"path":"D:\\云晟\\前端\\ant-design-vue-jeecg-464dd20b46384272b779e066c2f4fcdfa718b326\\src\\mixins\\JeecgListMixin.js","mtime":1665386876000},{"path":"D:\\云晟\\前端\\ant-design-vue-jeecg-464dd20b46384272b779e066c2f4fcdfa718b326\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1665642925904},{"path":"D:\\云晟\\前端\\ant-design-vue-jeecg-464dd20b46384272b779e066c2f4fcdfa718b326\\node_modules\\babel-loader\\lib\\index.js","mtime":1665642924601},{"path":"D:\\云晟\\前端\\ant-design-vue-jeecg-464dd20b46384272b779e066c2f4fcdfa718b326\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js","mtime":1665642923347}],"contextDependencies":[],"result":["/**\n * 新增修改完成调用 modalFormOk方法 编辑弹框组件ref定义为modalForm\n * 高级查询按钮调用 superQuery方法  高级查询组件ref定义为superQueryModal\n * data中url定义 list为查询列表  delete为删除单条记录  deleteBatch为批量删除\n */\nimport { filterObj } from '@/utils/util';\nimport { deleteAction, getAction, downFile, getFileAccessHttpUrl } from '@/api/manage';\nimport Vue from 'vue';\nimport { ACCESS_TOKEN, TENANT_ID } from \"@/store/mutation-types\";\nimport store from '@/store';\nexport var JeecgListMixin = {\n  data: function data() {\n    return {\n      /* 查询条件-请不要在queryParam中声明非字符串值的属性 */\n      queryParam: {},\n\n      /* 数据源 */\n      dataSource: [],\n\n      /* 分页参数 */\n      ipagination: {\n        current: 1,\n        pageSize: 10,\n        pageSizeOptions: ['10', '20', '30'],\n        showTotal: function showTotal(total, range) {\n          return range[0] + \"-\" + range[1] + \" 共\" + total + \"条\";\n        },\n        showQuickJumper: true,\n        showSizeChanger: true,\n        total: 0\n      },\n\n      /* 排序参数 */\n      isorter: {\n        column: 'createTime',\n        order: 'desc'\n      },\n\n      /* 筛选参数 */\n      filters: {},\n\n      /* table加载状态 */\n      loading: false,\n\n      /* table选中keys*/\n      selectedRowKeys: [],\n\n      /* table选中records*/\n      selectionRows: [],\n\n      /* 查询折叠 */\n      toggleSearchStatus: false,\n\n      /* 高级查询条件生效状态 */\n      superQueryFlag: false,\n\n      /* 高级查询条件 */\n      superQueryParams: '',\n\n      /** 高级查询拼接方式 */\n      superQueryMatchType: 'and'\n    };\n  },\n  created: function created() {\n    if (!this.disableMixinCreated) {\n      console.log(' -- mixin created -- ');\n      this.loadData(); //初始化字典配置 在自己页面定义\n\n      this.initDictConfig();\n    }\n  },\n  computed: {\n    //token header\n    tokenHeader: function tokenHeader() {\n      var head = {\n        'X-Access-Token': Vue.ls.get(ACCESS_TOKEN)\n      };\n      var tenantid = Vue.ls.get(TENANT_ID);\n\n      if (tenantid) {\n        head['tenant-id'] = tenantid;\n      }\n\n      return head;\n    }\n  },\n  methods: {\n    loadData: function loadData(arg) {\n      var _this = this;\n\n      if (!this.url.list) {\n        this.$message.error(\"请设置url.list属性!\");\n        return;\n      } //加载数据 若传入参数1则加载第一页的内容\n\n\n      if (arg === 1) {\n        this.ipagination.current = 1;\n      }\n\n      var params = this.getQueryParams(); //查询条件\n\n      this.loading = true;\n      getAction(this.url.list, params).then(function (res) {\n        if (res.success) {\n          //update-begin---author:zhangyafei    Date:20201118  for：适配不分页的数据列表------------\n          _this.dataSource = res.result.records || res.result;\n\n          if (res.result.total) {\n            _this.ipagination.total = res.result.total;\n          } else {\n            _this.ipagination.total = 0;\n          } //update-end---author:zhangyafei    Date:20201118  for：适配不分页的数据列表------------\n\n        } else {\n          _this.$message.warning(res.message);\n        }\n      }).finally(function () {\n        _this.loading = false;\n      });\n    },\n    initDictConfig: function initDictConfig() {\n      console.log(\"--这是一个假的方法!\");\n    },\n    handleSuperQuery: function handleSuperQuery(params, matchType) {\n      //高级查询方法\n      if (!params) {\n        this.superQueryParams = '';\n        this.superQueryFlag = false;\n      } else {\n        this.superQueryFlag = true;\n        this.superQueryParams = JSON.stringify(params);\n        this.superQueryMatchType = matchType;\n      }\n\n      this.loadData(1);\n    },\n    getQueryParams: function getQueryParams() {\n      //获取查询条件\n      var sqp = {};\n\n      if (this.superQueryParams) {\n        sqp['superQueryParams'] = encodeURI(this.superQueryParams);\n        sqp['superQueryMatchType'] = this.superQueryMatchType;\n      }\n\n      var param = Object.assign(sqp, this.queryParam, this.isorter, this.filters);\n      param.field = this.getQueryField();\n      param.pageNo = this.ipagination.current;\n      param.pageSize = this.ipagination.pageSize;\n      return filterObj(param);\n    },\n    getQueryField: function getQueryField() {\n      //TODO 字段权限控制\n      var str = \"id,\";\n      this.columns.forEach(function (value) {\n        str += \",\" + value.dataIndex;\n      });\n      return str;\n    },\n    onSelectChange: function onSelectChange(selectedRowKeys, selectionRows) {\n      this.selectedRowKeys = selectedRowKeys;\n      this.selectionRows = selectionRows;\n    },\n    onClearSelected: function onClearSelected() {\n      this.selectedRowKeys = [];\n      this.selectionRows = [];\n    },\n    searchQuery: function searchQuery() {\n      this.loadData(1); // 点击查询清空列表选中行\n      // https://gitee.com/jeecg/jeecg-boot/issues/I4KTU1\n\n      this.selectedRowKeys = [];\n      this.selectionRows = [];\n    },\n    superQuery: function superQuery() {\n      this.$refs.superQueryModal.show();\n    },\n    searchReset: function searchReset() {\n      this.queryParam = {};\n      this.loadData(1);\n    },\n    batchDel: function batchDel() {\n      if (!this.url.deleteBatch) {\n        this.$message.error(\"请设置url.deleteBatch属性!\");\n        return;\n      }\n\n      if (this.selectedRowKeys.length <= 0) {\n        this.$message.warning('请选择一条记录！');\n        return;\n      } else {\n        var ids = \"\";\n\n        for (var a = 0; a < this.selectedRowKeys.length; a++) {\n          ids += this.selectedRowKeys[a] + \",\";\n        }\n\n        var that = this;\n        this.$confirm({\n          title: \"确认删除\",\n          content: \"是否删除选中数据?\",\n          onOk: function onOk() {\n            that.loading = true;\n            deleteAction(that.url.deleteBatch, {\n              ids: ids\n            }).then(function (res) {\n              if (res.success) {\n                //重新计算分页问题\n                that.reCalculatePage(that.selectedRowKeys.length);\n                that.$message.success(res.message);\n                that.loadData();\n                that.onClearSelected();\n              } else {\n                that.$message.warning(res.message);\n              }\n            }).finally(function () {\n              that.loading = false;\n            });\n          }\n        });\n      }\n    },\n    handleDelete: function handleDelete(id) {\n      if (!this.url.delete) {\n        this.$message.error(\"请设置url.delete属性!\");\n        return;\n      }\n\n      var that = this;\n      deleteAction(that.url.delete, {\n        id: id\n      }).then(function (res) {\n        if (res.success) {\n          //重新计算分页问题\n          that.reCalculatePage(1);\n          that.$message.success(res.message);\n          that.loadData();\n        } else {\n          that.$message.warning(res.message);\n        }\n      });\n    },\n    reCalculatePage: function reCalculatePage(count) {\n      //总数量-count\n      var total = this.ipagination.total - count; //获取删除后的分页数\n\n      var currentIndex = Math.ceil(total / this.ipagination.pageSize); //删除后的分页数<所在当前页\n\n      if (currentIndex < this.ipagination.current) {\n        this.ipagination.current = currentIndex;\n      }\n\n      console.log('currentIndex', currentIndex);\n    },\n    handleEdit: function handleEdit(record) {\n      this.$refs.modalForm.edit(record);\n      this.$refs.modalForm.title = \"编辑\";\n      this.$refs.modalForm.disableSubmit = false;\n    },\n    handleAdd: function handleAdd() {\n      this.$refs.modalForm.add();\n      this.$refs.modalForm.title = \"新增\";\n      this.$refs.modalForm.disableSubmit = false;\n    },\n    handleTableChange: function handleTableChange(pagination, filters, sorter) {\n      //分页、排序、筛选变化时触发\n      //TODO 筛选\n      console.log(pagination);\n\n      if (Object.keys(sorter).length > 0) {\n        this.isorter.column = sorter.field;\n        this.isorter.order = \"ascend\" == sorter.order ? \"asc\" : \"desc\";\n      }\n\n      this.ipagination = pagination;\n      this.loadData();\n    },\n    handleToggleSearch: function handleToggleSearch() {\n      this.toggleSearchStatus = !this.toggleSearchStatus;\n    },\n    // 给popup查询使用(查询区域不支持回填多个字段，限制只返回一个字段)\n    getPopupField: function getPopupField(fields) {\n      return fields.split(',')[0];\n    },\n    modalFormOk: function modalFormOk() {\n      // 新增/修改 成功时，重载列表\n      this.loadData(); //清空列表选中\n\n      this.onClearSelected();\n    },\n    handleDetail: function handleDetail(record) {\n      this.$refs.modalForm.edit(record);\n      this.$refs.modalForm.title = \"详情\";\n      this.$refs.modalForm.disableSubmit = true;\n    },\n\n    /* 导出 */\n    handleExportXls2: function handleExportXls2() {\n      var paramsStr = encodeURI(JSON.stringify(this.getQueryParams()));\n      var url = \"\".concat(window._CONFIG['domianURL'], \"/\").concat(this.url.exportXlsUrl, \"?paramsStr=\").concat(paramsStr);\n      window.location.href = url;\n    },\n    handleExportXls: function handleExportXls(fileName) {\n      var _this2 = this;\n\n      if (!fileName || typeof fileName != \"string\") {\n        fileName = \"导出文件\";\n      }\n\n      var param = this.getQueryParams();\n\n      if (this.selectedRowKeys && this.selectedRowKeys.length > 0) {\n        param['selections'] = this.selectedRowKeys.join(\",\");\n      }\n\n      console.log(\"导出参数\", param);\n      downFile(this.url.exportXlsUrl, param).then(function (data) {\n        if (!data) {\n          _this2.$message.warning(\"文件下载失败\");\n\n          return;\n        }\n\n        if (typeof window.navigator.msSaveBlob !== 'undefined') {\n          window.navigator.msSaveBlob(new Blob([data], {\n            type: 'application/vnd.ms-excel'\n          }), fileName + '.xls');\n        } else {\n          var url = window.URL.createObjectURL(new Blob([data], {\n            type: 'application/vnd.ms-excel'\n          }));\n          var link = document.createElement('a');\n          link.style.display = 'none';\n          link.href = url;\n          link.setAttribute('download', fileName + '.xls');\n          document.body.appendChild(link);\n          link.click();\n          document.body.removeChild(link); //下载完成移除元素\n\n          window.URL.revokeObjectURL(url); //释放掉blob对象\n        }\n      });\n    },\n\n    /* 导入 */\n    handleImportExcel: function handleImportExcel(info) {\n      var h = this.$createElement;\n      this.loading = true;\n\n      if (info.file.status !== 'uploading') {\n        console.log(info.file, info.fileList);\n      }\n\n      if (info.file.status === 'done') {\n        this.loading = false;\n\n        if (info.file.response.success) {\n          // this.$message.success(`${info.file.name} 文件上传成功`);\n          if (info.file.response.code === 201) {\n            var _info$file$response = info.file.response,\n                message = _info$file$response.message,\n                _info$file$response$r = _info$file$response.result,\n                msg = _info$file$response$r.msg,\n                fileUrl = _info$file$response$r.fileUrl,\n                fileName = _info$file$response$r.fileName;\n            var href = window._CONFIG['domianURL'] + fileUrl;\n            this.$warning({\n              title: message,\n              content: h(\"div\", [h(\"span\", [msg]), h(\"br\"), h(\"span\", [\"\\u5177\\u4F53\\u8BE6\\u60C5\\u8BF7 \", h(\"a\", {\n                \"attrs\": {\n                  \"href\": href,\n                  \"target\": \"_blank\",\n                  \"download\": fileName\n                }\n              }, [\"\\u70B9\\u51FB\\u4E0B\\u8F7D\"]), \" \"])])\n            });\n          } else {\n            this.$message.success(info.file.response.message || \"\".concat(info.file.name, \" \\u6587\\u4EF6\\u4E0A\\u4F20\\u6210\\u529F\"));\n          }\n\n          this.loadData();\n        } else {\n          this.$message.error(\"\".concat(info.file.name, \" \").concat(info.file.response.message, \".\"));\n        }\n      } else if (info.file.status === 'error') {\n        this.loading = false;\n\n        if (info.file.response.status === 500) {\n          var data = info.file.response;\n          var token = Vue.ls.get(ACCESS_TOKEN);\n\n          if (token && data.message.includes(\"Token失效\")) {\n            this.$error({\n              title: '登录已过期',\n              content: '很抱歉，登录已过期，请重新登录',\n              okText: '重新登录',\n              mask: false,\n              onOk: function onOk() {\n                store.dispatch('Logout').then(function () {\n                  Vue.ls.remove(ACCESS_TOKEN);\n                  window.location.reload();\n                });\n              }\n            });\n          }\n        } else {\n          this.$message.error(\"\\u6587\\u4EF6\\u4E0A\\u4F20\\u5931\\u8D25: \".concat(info.file.msg, \" \"));\n        }\n      }\n    },\n\n    /* 图片预览 */\n    getImgView: function getImgView(text) {\n      if (text && text.indexOf(\",\") > 0) {\n        text = text.substring(0, text.indexOf(\",\"));\n      }\n\n      return getFileAccessHttpUrl(text);\n    },\n\n    /* 文件下载 */\n    // update--autor:lvdandan-----date:20200630------for：修改下载文件方法名uploadFile改为downloadFile------\n    downloadFile: function downloadFile(text) {\n      if (!text) {\n        this.$message.warning(\"未知的文件\");\n        return;\n      }\n\n      if (text.indexOf(\",\") > 0) {\n        text = text.substring(0, text.indexOf(\",\"));\n      }\n\n      var url = getFileAccessHttpUrl(text);\n      window.open(url);\n    }\n  }\n};",{"version":3,"sources":["D:/云晟/前端/ant-design-vue-jeecg-464dd20b46384272b779e066c2f4fcdfa718b326/src/mixins/JeecgListMixin.js"],"names":["filterObj","deleteAction","getAction","downFile","getFileAccessHttpUrl","Vue","ACCESS_TOKEN","TENANT_ID","store","JeecgListMixin","data","queryParam","dataSource","ipagination","current","pageSize","pageSizeOptions","showTotal","total","range","showQuickJumper","showSizeChanger","isorter","column","order","filters","loading","selectedRowKeys","selectionRows","toggleSearchStatus","superQueryFlag","superQueryParams","superQueryMatchType","created","disableMixinCreated","console","log","loadData","initDictConfig","computed","tokenHeader","head","ls","get","tenantid","methods","arg","url","list","$message","error","params","getQueryParams","then","res","success","result","records","warning","message","finally","handleSuperQuery","matchType","JSON","stringify","sqp","encodeURI","param","Object","assign","field","getQueryField","pageNo","str","columns","forEach","value","dataIndex","onSelectChange","onClearSelected","searchQuery","superQuery","$refs","superQueryModal","show","searchReset","batchDel","deleteBatch","length","ids","a","that","$confirm","title","content","onOk","reCalculatePage","handleDelete","id","delete","count","currentIndex","Math","ceil","handleEdit","record","modalForm","edit","disableSubmit","handleAdd","add","handleTableChange","pagination","sorter","keys","handleToggleSearch","getPopupField","fields","split","modalFormOk","handleDetail","handleExportXls2","paramsStr","window","_CONFIG","exportXlsUrl","location","href","handleExportXls","fileName","join","navigator","msSaveBlob","Blob","type","URL","createObjectURL","link","document","createElement","style","display","setAttribute","body","appendChild","click","removeChild","revokeObjectURL","handleImportExcel","info","file","status","fileList","response","code","msg","fileUrl","$warning","name","token","includes","$error","okText","mask","dispatch","remove","reload","getImgView","text","indexOf","substring","downloadFile","open"],"mappings":"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","sourcesContent":["/**\n * 新增修改完成调用 modalFormOk方法 编辑弹框组件ref定义为modalForm\n * 高级查询按钮调用 superQuery方法  高级查询组件ref定义为superQueryModal\n * data中url定义 list为查询列表  delete为删除单条记录  deleteBatch为批量删除\n */\nimport { filterObj } from '@/utils/util';\nimport { deleteAction, getAction,downFile,getFileAccessHttpUrl } from '@/api/manage'\nimport Vue from 'vue'\nimport { ACCESS_TOKEN, TENANT_ID } from \"@/store/mutation-types\"\nimport store from '@/store'\n\nexport const JeecgListMixin = {\n  data(){\n    return {\n      /* 查询条件-请不要在queryParam中声明非字符串值的属性 */\n      queryParam: {},\n      /* 数据源 */\n      dataSource:[],\n      /* 分页参数 */\n      ipagination:{\n        current: 1,\n        pageSize: 10,\n        pageSizeOptions: ['10', '20', '30'],\n        showTotal: (total, range) => {\n          return range[0] + \"-\" + range[1] + \" 共\" + total + \"条\"\n        },\n        showQuickJumper: true,\n        showSizeChanger: true,\n        total: 0\n      },\n      /* 排序参数 */\n      isorter:{\n        column: 'createTime',\n        order: 'desc',\n      },\n      /* 筛选参数 */\n      filters: {},\n      /* table加载状态 */\n      loading:false,\n      /* table选中keys*/\n      selectedRowKeys: [],\n      /* table选中records*/\n      selectionRows: [],\n      /* 查询折叠 */\n      toggleSearchStatus:false,\n      /* 高级查询条件生效状态 */\n      superQueryFlag:false,\n      /* 高级查询条件 */\n      superQueryParams: '',\n      /** 高级查询拼接方式 */\n      superQueryMatchType: 'and',\n    }\n  },\n  created() {\n      if(!this.disableMixinCreated){\n        console.log(' -- mixin created -- ')\n        this.loadData();\n        //初始化字典配置 在自己页面定义\n        this.initDictConfig();\n      }\n  },\n  computed: {\n    //token header\n    tokenHeader(){\n      let head = {'X-Access-Token': Vue.ls.get(ACCESS_TOKEN)}\n      let tenantid = Vue.ls.get(TENANT_ID)\n      if(tenantid){\n        head['tenant-id'] = tenantid\n      }\n      return head;\n    }\n  },\n  methods:{\n    loadData(arg) {\n      if(!this.url.list){\n        this.$message.error(\"请设置url.list属性!\")\n        return\n      }\n      //加载数据 若传入参数1则加载第一页的内容\n      if (arg === 1) {\n        this.ipagination.current = 1;\n      }\n      var params = this.getQueryParams();//查询条件\n      this.loading = true;\n      getAction(this.url.list, params).then((res) => {\n        if (res.success) {\n          //update-begin---author:zhangyafei    Date:20201118  for：适配不分页的数据列表------------\n          this.dataSource = res.result.records||res.result;\n          if(res.result.total)\n          {\n            this.ipagination.total = res.result.total;\n          }else{\n            this.ipagination.total = 0;\n          }\n          //update-end---author:zhangyafei    Date:20201118  for：适配不分页的数据列表------------\n        }else{\n          this.$message.warning(res.message)\n        }\n      }).finally(() => {\n        this.loading = false\n      })\n    },\n    initDictConfig(){\n      console.log(\"--这是一个假的方法!\")\n    },\n    handleSuperQuery(params, matchType) {\n      //高级查询方法\n      if(!params){\n        this.superQueryParams=''\n        this.superQueryFlag = false\n      }else{\n        this.superQueryFlag = true\n        this.superQueryParams=JSON.stringify(params)\n        this.superQueryMatchType = matchType\n      }\n      this.loadData(1)\n    },\n    getQueryParams() {\n      //获取查询条件\n      let sqp = {}\n      if(this.superQueryParams){\n        sqp['superQueryParams']=encodeURI(this.superQueryParams)\n        sqp['superQueryMatchType'] = this.superQueryMatchType\n      }\n      var param = Object.assign(sqp, this.queryParam, this.isorter ,this.filters);\n      param.field = this.getQueryField();\n      param.pageNo = this.ipagination.current;\n      param.pageSize = this.ipagination.pageSize;\n      return filterObj(param);\n    },\n    getQueryField() {\n      //TODO 字段权限控制\n      var str = \"id,\";\n      this.columns.forEach(function (value) {\n        str += \",\" + value.dataIndex;\n      });\n      return str;\n    },\n\n    onSelectChange(selectedRowKeys, selectionRows) {\n      this.selectedRowKeys = selectedRowKeys;\n      this.selectionRows = selectionRows;\n    },\n    onClearSelected() {\n      this.selectedRowKeys = [];\n      this.selectionRows = [];\n    },\n    searchQuery() {\n      this.loadData(1);\n      // 点击查询清空列表选中行\n      // https://gitee.com/jeecg/jeecg-boot/issues/I4KTU1\n      this.selectedRowKeys = []\n      this.selectionRows = []\n    },\n    superQuery() {\n      this.$refs.superQueryModal.show();\n    },\n    searchReset() {\n      this.queryParam = {}\n      this.loadData(1);\n    },\n    batchDel: function () {\n      if(!this.url.deleteBatch){\n        this.$message.error(\"请设置url.deleteBatch属性!\")\n        return\n      }\n      if (this.selectedRowKeys.length <= 0) {\n        this.$message.warning('请选择一条记录！');\n        return;\n      } else {\n        var ids = \"\";\n        for (var a = 0; a < this.selectedRowKeys.length; a++) {\n          ids += this.selectedRowKeys[a] + \",\";\n        }\n        var that = this;\n        this.$confirm({\n          title: \"确认删除\",\n          content: \"是否删除选中数据?\",\n          onOk: function () {\n            that.loading = true;\n            deleteAction(that.url.deleteBatch, {ids: ids}).then((res) => {\n              if (res.success) {\n                //重新计算分页问题\n                that.reCalculatePage(that.selectedRowKeys.length)\n                that.$message.success(res.message);\n                that.loadData();\n                that.onClearSelected();\n              } else {\n                that.$message.warning(res.message);\n              }\n            }).finally(() => {\n              that.loading = false;\n            });\n          }\n        });\n      }\n    },\n    handleDelete: function (id) {\n      if(!this.url.delete){\n        this.$message.error(\"请设置url.delete属性!\")\n        return\n      }\n      var that = this;\n      deleteAction(that.url.delete, {id: id}).then((res) => {\n        if (res.success) {\n          //重新计算分页问题\n          that.reCalculatePage(1)\n          that.$message.success(res.message);\n          that.loadData();\n        } else {\n          that.$message.warning(res.message);\n        }\n      });\n    },\n    reCalculatePage(count){\n      //总数量-count\n      let total=this.ipagination.total-count;\n      //获取删除后的分页数\n      let currentIndex=Math.ceil(total/this.ipagination.pageSize);\n      //删除后的分页数<所在当前页\n      if(currentIndex<this.ipagination.current){\n        this.ipagination.current=currentIndex;\n      }\n      console.log('currentIndex',currentIndex)\n    },\n    handleEdit: function (record) {\n      this.$refs.modalForm.edit(record);\n      this.$refs.modalForm.title = \"编辑\";\n      this.$refs.modalForm.disableSubmit = false;\n    },\n    handleAdd: function () {\n      this.$refs.modalForm.add();\n      this.$refs.modalForm.title = \"新增\";\n      this.$refs.modalForm.disableSubmit = false;\n    },\n    handleTableChange(pagination, filters, sorter) {\n      //分页、排序、筛选变化时触发\n      //TODO 筛选\n      console.log(pagination)\n      if (Object.keys(sorter).length > 0) {\n        this.isorter.column = sorter.field;\n        this.isorter.order = \"ascend\" == sorter.order ? \"asc\" : \"desc\"\n      }\n      this.ipagination = pagination;\n      this.loadData();\n    },\n    handleToggleSearch(){\n      this.toggleSearchStatus = !this.toggleSearchStatus;\n    },\n    // 给popup查询使用(查询区域不支持回填多个字段，限制只返回一个字段)\n    getPopupField(fields){\n      return fields.split(',')[0]\n    },\n    modalFormOk() {\n      // 新增/修改 成功时，重载列表\n      this.loadData();\n      //清空列表选中\n      this.onClearSelected()\n    },\n    handleDetail:function(record){\n      this.$refs.modalForm.edit(record);\n      this.$refs.modalForm.title=\"详情\";\n      this.$refs.modalForm.disableSubmit = true;\n    },\n    /* 导出 */\n    handleExportXls2(){\n      let paramsStr = encodeURI(JSON.stringify(this.getQueryParams()));\n      let url = `${window._CONFIG['domianURL']}/${this.url.exportXlsUrl}?paramsStr=${paramsStr}`;\n      window.location.href = url;\n    },\n    handleExportXls(fileName){\n      if(!fileName || typeof fileName != \"string\"){\n        fileName = \"导出文件\"\n      }\n      let param = this.getQueryParams();\n      if(this.selectedRowKeys && this.selectedRowKeys.length>0){\n        param['selections'] = this.selectedRowKeys.join(\",\")\n      }\n      console.log(\"导出参数\",param)\n      downFile(this.url.exportXlsUrl,param).then((data)=>{\n        if (!data) {\n          this.$message.warning(\"文件下载失败\")\n          return\n        }\n        if (typeof window.navigator.msSaveBlob !== 'undefined') {\n          window.navigator.msSaveBlob(new Blob([data],{type: 'application/vnd.ms-excel'}), fileName+'.xls')\n        }else{\n          let url = window.URL.createObjectURL(new Blob([data],{type: 'application/vnd.ms-excel'}))\n          let link = document.createElement('a')\n          link.style.display = 'none'\n          link.href = url\n          link.setAttribute('download', fileName+'.xls')\n          document.body.appendChild(link)\n          link.click()\n          document.body.removeChild(link); //下载完成移除元素\n          window.URL.revokeObjectURL(url); //释放掉blob对象\n        }\n      })\n    },\n    /* 导入 */\n    handleImportExcel(info){\n      this.loading = true;\n      if (info.file.status !== 'uploading') {\n        console.log(info.file, info.fileList);\n      }\n      if (info.file.status === 'done') {\n        this.loading = false;\n        if (info.file.response.success) {\n          // this.$message.success(`${info.file.name} 文件上传成功`);\n          if (info.file.response.code === 201) {\n            let { message, result: { msg, fileUrl, fileName } } = info.file.response\n            let href = window._CONFIG['domianURL'] + fileUrl\n            this.$warning({\n              title: message,\n              content: (<div>\n                  <span>{msg}</span><br/>\n                  <span>具体详情请 <a href={href} target=\"_blank\" download={fileName}>点击下载</a> </span>\n                </div>\n              )\n            })\n          } else {\n            this.$message.success(info.file.response.message || `${info.file.name} 文件上传成功`)\n          }\n          this.loadData()\n        } else {\n          this.$message.error(`${info.file.name} ${info.file.response.message}.`);\n        }\n      } else if (info.file.status === 'error') {\n        this.loading = false;\n        if (info.file.response.status === 500) {\n          let data = info.file.response\n          const token = Vue.ls.get(ACCESS_TOKEN)\n          if (token && data.message.includes(\"Token失效\")) {\n            this.$error({\n              title: '登录已过期',\n              content: '很抱歉，登录已过期，请重新登录',\n              okText: '重新登录',\n              mask: false,\n              onOk: () => {\n                store.dispatch('Logout').then(() => {\n                  Vue.ls.remove(ACCESS_TOKEN)\n                  window.location.reload();\n                })\n              }\n            })\n          }\n        } else {\n          this.$message.error(`文件上传失败: ${info.file.msg} `);\n        }\n      }\n    },\n    /* 图片预览 */\n    getImgView(text){\n      if(text && text.indexOf(\",\")>0){\n        text = text.substring(0,text.indexOf(\",\"))\n      }\n      return getFileAccessHttpUrl(text)\n    },\n    /* 文件下载 */\n    // update--autor:lvdandan-----date:20200630------for：修改下载文件方法名uploadFile改为downloadFile------\n    downloadFile(text){\n      if(!text){\n        this.$message.warning(\"未知的文件\")\n        return;\n      }\n      if(text.indexOf(\",\")>0){\n        text = text.substring(0,text.indexOf(\",\"))\n      }\n      let url = getFileAccessHttpUrl(text)\n      window.open(url);\n    },\n  }\n\n}"]}]}